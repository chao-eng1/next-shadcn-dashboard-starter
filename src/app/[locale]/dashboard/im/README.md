# IM æ¨¡å—

## æ¨¡å—æ¦‚è¿°

å³æ—¶é€šè®¯æ¨¡å—ï¼Œæä¾›ä¼ä¸šçº§å³æ—¶æ¶ˆæ¯æœåŠ¡ï¼Œæ”¯æŒä¸ªäººèŠå¤©ã€ç¾¤ç»„èŠå¤©ã€æ–‡ä»¶ä¼ è¾“ç­‰åŠŸèƒ½ã€‚

## ä¸»è¦åŠŸèƒ½

- ðŸ’¬ ä¸€å¯¹ä¸€ç§èŠ
- ðŸ‘¥ ç¾¤ç»„èŠå¤©ç®¡ç†
- ðŸ“± æ¶ˆæ¯æŽ¨é€é€šçŸ¥
- ðŸ“Ž æ–‡ä»¶å’Œå›¾ç‰‡ä¼ è¾“
- ðŸŽ¤ è¯­éŸ³æ¶ˆæ¯æ”¯æŒ
- ðŸ“¹ è§†é¢‘é€šè¯é›†æˆ
- ðŸ”’ ç«¯åˆ°ç«¯åŠ å¯†
- ðŸ“‹ æ¶ˆæ¯æ’¤å›žå’Œç¼–è¾‘
- ðŸ” èŠå¤©è®°å½•æœç´¢
- ðŸ‘¤ ç”¨æˆ·åœ¨çº¿çŠ¶æ€

## æŠ€æœ¯æ ˆ

- **WebSocket**: å®žæ—¶é€šä¿¡åè®®
- **Socket.io**: å®žæ—¶é€šä¿¡åº“
- **WebRTC**: éŸ³è§†é¢‘é€šè¯
- **Zustand**: çŠ¶æ€ç®¡ç†
- **React**: å‰ç«¯æ¡†æž¶
- **shadcn/ui**: UI ç»„ä»¶

## æ–‡ä»¶ç»“æž„

```
im/
â”œâ”€â”€ page.tsx              # IM ä¸»ç•Œé¢
â”œâ”€â”€ components/
â”‚   â”œâ”€â”€ ChatWindow.tsx    # èŠå¤©çª—å£
â”‚   â”œâ”€â”€ ContactList.tsx   # è”ç³»äººåˆ—è¡¨
â”‚   â”œâ”€â”€ MessageInput.tsx  # æ¶ˆæ¯è¾“å…¥æ¡†
â”‚   â””â”€â”€ FileUpload.tsx    # æ–‡ä»¶ä¸Šä¼ ç»„ä»¶
â””â”€â”€ hooks/
    â”œâ”€â”€ useChat.ts        # èŠå¤©é€»è¾‘ Hook
    â””â”€â”€ useWebRTC.ts      # éŸ³è§†é¢‘é€šè¯ Hook
```

## æ ¸å¿ƒç»„ä»¶

- **ChatWindow**: èŠå¤©çª—å£ä¸»ç»„ä»¶
- **MessageBubble**: æ¶ˆæ¯æ°”æ³¡ç»„ä»¶
- **ContactList**: è”ç³»äººå’Œç¾¤ç»„åˆ—è¡¨
- **FilePreview**: æ–‡ä»¶é¢„è§ˆç»„ä»¶
- **VoiceRecorder**: è¯­éŸ³å½•åˆ¶ç»„ä»¶

## å¼€å‘æ³¨æ„äº‹é¡¹

- WebSocket è¿žæŽ¥çŠ¶æ€ç®¡ç†
- æ¶ˆæ¯åŠ å¯†å’Œå®‰å…¨ä¼ è¾“
- æ–‡ä»¶ä¸Šä¼ å¤§å°å’Œæ ¼å¼é™åˆ¶
- éŸ³è§†é¢‘æƒé™ç”³è¯·å¤„ç†
- ç¦»çº¿æ¶ˆæ¯åŒæ­¥æœºåˆ¶

## API ç«¯ç‚¹

- `/api/im/messages` - æ¶ˆæ¯ç®¡ç†
- `/api/im/contacts` - è”ç³»äººç®¡ç†
- `/api/im/groups` - ç¾¤ç»„ç®¡ç†
- `/api/im/files` - æ–‡ä»¶ä¼ è¾“

## WebSocket äº‹ä»¶

```typescript
// å‘é€æ¶ˆæ¯
socket.emit('sendMessage', { to, content, type });

// æŽ¥æ”¶æ¶ˆæ¯
socket.on('messageReceived', (message) => {});

// ç”¨æˆ·çŠ¶æ€å˜åŒ–
socket.on('userStatusChanged', (status) => {});
```
